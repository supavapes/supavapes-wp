"use strict";jQuery(document).ready(function(a){function d(){var t=!1;return a("#woocommerce_moneris_configured_currencies option").each(function(){var e=a(this).val().toLowerCase();1<=a("."+e+"-field .js-remove-connection-settings").length?a(this).hide():t=!0}),t}function t(e){var t,i,n,c=a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_environment").val();t=e.data("currency"),i=e.val(),n=c,(e=a(".integration-field."+t+"-field").not(".hidden")).closest("tr").hide(),e.filter("."+i+"-field."+n+"-field").closest("tr").show(),a("."+t+"-field.hosted-tokenization-field."+n+"-field").each(function(){var e=a(this),t=e.data(i+"-"+n+"-merchant-center-url");t&&e.closest("tr").find(".description a").attr("href",t)}),e=a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_dynamic_descriptor").closest("td").find(".description"),a('.js-integration-country-field option[value="us"]:selected:visible').length?e.show():e.hide()}function e(e){e=e.attr("class").match(/currency-field (\w{3})-field/);e&&a(".currency-field."+e[1]+"-field").data("currency",e[1]).find(".js-remove-connection-settings").data("currency",e[1])}a(".currency-field").closest("tr").find(".woocommerce-help-tip").each(function(){a(this).attr("data-original-tip",a(this).attr("data-tip"))}),a(".currency-field.hidden").closest("tr").hide(),a(".wc-settings-sub-title.currency-field.xxx-field + p").hide(),a(".js-connection-settings-title").each(function(){a(this).append('<a href="#" title="'+wc_moneris_admin.remove_connection_settings_label+'" class="js-remove-connection-settings" style="text-decoration: none"><span class="dashicons dashicons-trash"></span></a>'),e(a(this))}),a(".js-integration-country-field").each(function(){e(a(this))}),d()||a("#wc-settings-additional-connection-settings").hide(),a("#wc-moneris-migrate-button").on("click",function(e){window.confirm("Have you added your Checkout ID in the gateway settings? Transactions will stop if you proceed without it.\nPlease click OK to proceed or Cancel to go back.")||e.preventDefault()}),setTimeout(function(){a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_configured_currencies").on("change",function(){a("#js-add-connection-settings").text(wc_moneris_admin.add_connection_settings_label.replace("%s",a(this).val()))}),a("#js-add-connection-settings").on("click",function(e){var t,i,n,c,o,r;e.preventDefault(),e=a(this).closest("div").prev("table"),o=a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_configured_currencies"),r=o.val().toLowerCase(),1<=a(".currency-field."+r+"-field").length||(t=a(".wc-settings-sub-title.currency-field.xxx-field").clone(),i=a(".wc-settings-sub-title.currency-field.xxx-field + p").clone(),n=a(".currency-field.xxx-field").closest("tr").clone(),t.attr("id",t.attr("id").replace("xxx",r)),t.html(t.html().replace("XXX",r.toUpperCase())),i.text(i.text().replace("XXX",r.toUpperCase())),(c=n.find(".xxx-field").each(function(){var e=a(this),t=e.closest("tr").find("label[for]");t.attr("for",t.attr("for").replace("xxx",r)),e.attr("name",e.attr("name").replace("xxx",r)),e.attr("id",e.attr("id").replace("xxx",r))})).filter(".js-integration-country-field").val(wc_moneris_admin[r+"_default_integration"]),t.removeClass("hidden xxx-field").addClass(r+"-field"),c.removeClass("hidden xxx-field").addClass(r+"-field"),t.insertAfter(e).show(),i.insertAfter(t).show(),a('<table class="form-table"></table>').append(n.show()).insertAfter(i),o.closest("fieldset").append('<input type="hidden" name="'+o.attr("id")+'[]" value="'+r.toUpperCase()+'">'),n.find(".woocommerce-help-tip").each(function(e,t){return a(t).attr("data-tip",a(t).attr("data-original-tip"))}).tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),d()||a("#wc-settings-additional-connection-settings").hide(),a("body").trigger("sv_wc_connection_settings_added",[r]))}),a("#mainform").on("click",".js-remove-connection-settings",function(e){var t,i;e.preventDefault(),e=a(this),t=e.data("currency"),(i=(i=(i=a(".wc-settings-sub-title.currency-field."+t+"-field")).add(".wc-settings-sub-title.currency-field."+t+"-field + p")).add(a(".currency-field."+t+"-field").closest("tr"))).delay(50).fadeOut(400).promise().done(function(){i.remove(),a('[name="woocommerce_'+wc_moneris_admin.credit_card_gateway_id+'_configured_currencies[]"][value="'+t.toUpperCase()+'"]').val("")}),a("#wc-settings-additional-connection-settings").show()}),a("body").on("sv_wc_connection_settings_added",function(e,t){a(".currency-field."+t+"-field").data("currency",t),a(".currency-field."+t+"-field .js-remove-connection-settings").data("currency",t),a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_environment").trigger("change")}),a("#mainform").on("change",".js-integration-country-field",function(){t(a(this))}),a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_environment").on("change",function(){var e=a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_environment");"test"===e.val()?0===a("#wc-moneris-sandbox-credentials-info").length?e.after('<p id="wc-moneris-sandbox-credentials-info" class="description">'+wc_moneris_admin.sandbox_credentials_description+"</p>"):a("#wc-moneris-sandbox-credentials-info").show():a("#wc-moneris-sandbox-credentials-info").hide(),a(".js-integration-country-field").each(function(){t(a(this))})}).change(),a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_enable_avs").change(function(){a(this).is(":checked")?a(".avs-field").closest("tr").show():a(".avs-field").closest("tr").hide()}).change(),a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_enable_csc").change(function(){a(this).is(":checked")?a(".csc-field").closest("tr").show():a(".csc-field").closest("tr").hide()}).change(),a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_enable_csc, #woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_tokenization").change(function(){a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_enable_csc").is(":checked")&&a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_tokenization").is(":checked")?a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_require_csc").closest("tr").show():a("#woocommerce_"+wc_moneris_admin.credit_card_gateway_id+"_require_csc").closest("tr").hide()}).change()},300)});